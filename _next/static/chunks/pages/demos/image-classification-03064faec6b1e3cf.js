(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[839],{277:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/demos/image-classification",function(){return t(3099)}])},3099:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return h}});var i=t(5893),n=t(5817),a=t(9008),c=t.n(a),l=t(7294),r=t(4540),d=t(5108);function h(){let e=(0,l.useRef)(null),s=(0,l.useRef)(null),t=(0,l.useRef)(null),[a,h]=(0,l.useState)({width:0,height:0,aspectRatio:1}),o=function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(e.current){let t=e.current.offsetWidth-11;h({width:t=t>800?800:t,height:t*s,aspectRatio:s})}};(0,l.useEffect)(()=>{o(),j()},[]);let[m,u]=(0,l.useState)({results:[]}),[f,g]=(0,l.useState)({}),[x,p]=(0,l.useState)({message:"ready",processing:!1}),j=async()=>{p({message:"loading the model",processing:!0});let e=await r.V6.create("mobilevit-small");g({instance:e.model}),p({message:"ready",processing:!1})},w=()=>{if(t.current&&t.current.files&&t.current.files[0]){var e=new FileReader;e.onload=async()=>{v(e.result)},e.readAsArrayBuffer(t.current.files[0])}},v=async e=>{p({message:"processing the image",processing:!0});var t=await n.Z.read(e);o(t.bitmap.height/t.bitmap.width);let i=new ImageData(new Uint8ClampedArray(t.bitmap.data),t.bitmap.width,t.bitmap.height),a=document.createElement("canvas");a.width=t.bitmap.width,a.height=t.bitmap.height;let c=a.getContext("2d");c.putImageData(i,0,0),s.current.src=a.toDataURL("image/png");let l=await f.instance.process(e);d.log("Inference finished in ".concat(l.elapsed," seconds.")),u({results:l.results}),p({message:"processing finished",processing:!1})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(c(),{children:[(0,i.jsx)("title",{children:"Web AI Next.js classification example"}),(0,i.jsx)("meta",{name:"description",content:"Web AI Next.js classification example"}),(0,i.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,i.jsx)("main",{children:(0,i.jsxs)("div",{className:"container",children:[(0,i.jsx)("div",{className:"row",children:(0,i.jsx)("div",{className:"col",children:(0,i.jsx)("h2",{children:"Image classification"})})}),(0,i.jsx)("div",{className:"row",children:(0,i.jsx)("div",{className:"col",children:(0,i.jsx)("div",{className:"d-flex align-items-center",children:(0,i.jsxs)("strong",{children:["Status: ",x.message]})})})}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsxs)("div",{className:"col-md-6 col-sm-12 mb-2",children:[(0,i.jsx)("div",{ref:e,style:{position:"relative",height:a.height},children:(0,i.jsx)("img",{alt:"",ref:s,width:a.width,height:a.height,style:{position:"absolute",top:0,left:0}})}),m.results&&m.results.length>0&&(0,i.jsxs)("table",{className:"table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Class"}),(0,i.jsx)("th",{children:"Confidence"})]})}),(0,i.jsx)("tbody",{children:m.results.map((e,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.class}),(0,i.jsx)("td",{children:Math.round(1e4*e.confidence)/1e4})]},e.class))})]})]}),(0,i.jsx)("div",{className:"col-md-6 col-sm-12 mb-2",children:(0,i.jsxs)("form",{action:"#",onSubmit:e=>e.preventDefault(),children:[(0,i.jsx)("h6",{children:"Select the image"}),(0,i.jsx)("div",{className:"row",children:(0,i.jsx)("div",{className:"mb-3",children:(0,i.jsx)("input",{className:"form-control",type:"file",ref:t,onChange:w,disabled:x.processing})})})]})})]})]})})]})}},2987:function(){},8104:function(){},3731:function(){}},function(e){e.O(0,[770,655,362,444,774,888,179],function(){return e(e.s=277)}),_N_E=e.O()}]);